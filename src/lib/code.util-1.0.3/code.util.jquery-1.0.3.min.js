// Util
// Copyright (c) 2011 by Code Computerlove (http://www.codecomputerlove.com)
// Licensed under the MIT license
// version: 1.0.3
(function(e){if(!Function.prototype.bind)Function.prototype.bind=function(b){var a=[].slice,d=a.call(arguments,1),c=this,g=function(){},e=function(){return c.apply(this instanceof g?this:b||{},d.concat(a.call(arguments)))};g.prototype=c.prototype;e.prototype=new g;return e};if(typeof e.Code==="undefined")e.Code={};e.Code.Util={registerNamespace:function(){var b=arguments,a=null,d,c,g,f,h;d=0;for(f=b.length;d<f;d++){g=b[d];g=g.split(".");a=g[0];typeof e[a]==="undefined"&&(e[a]={});a=e[a];c=1;for(h=
g.length;c<h;++c)a[g[c]]=a[g[c]]||{},a=a[g[c]]}},coalesce:function(){var b,a;b=0;for(a=arguments.length;b<a;b++)if(!this.isNothing(arguments[b]))return arguments[b];return null},extend:function(b,a,d){var c;this.isNothing(d)&&(d=!0);if(b&&a&&this.isObject(a))for(c in a)this.objectHasProperty(a,c)&&(d?b[c]=a[c]:typeof b[c]==="undefined"&&(b[c]=a[c]))},clone:function(b){var a={};this.extend(a,b);return a},isObject:function(b){return b instanceof Object},isFunction:function(b){return{}.toString.call(b)===
"[object Function]"},isArray:function(b){return b instanceof Array},isLikeArray:function(b){return typeof b.length==="number"},isNumber:function(b){return typeof b==="number"},isString:function(b){return typeof b==="string"},isNothing:function(b){if(typeof b==="undefined"||b===null)return!0;return!1},swapArrayElements:function(b,a,d){var c=b[a];b[a]=b[d];b[d]=c},trim:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(b){return b.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-",
"")})},toDashedCase:function(b){return b.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},arrayIndexOf:function(b,a,d){var c,g,e,h;e=-1;c=0;for(g=a.length;c<g;c++)if(h=a[c],this.isNothing(d)){if(h===b){e=c;break}}else if(this.objectHasProperty(h,d)&&h[d]===b){e=c;break}return e},objectHasProperty:function(b,a){return b.hasOwnProperty?b.hasOwnProperty(a):"undefined"!==typeof b[a]}}})(window);
(function(e,b){b.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=e.navigator.userAgent;this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[];this.safari=/Safari/gi.test(e.navigator.appVersion);this.webkit=/webkit/i.test(this.ua);this.opera=/opera/i.test(this.ua);
this.msie=/msie/i.test(this.ua)&&!this.opera;this.chrome=/Chrome/i.test(this.ua);this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua);this.android=/android/i.test(this.ua);this.blackberry=/blackberry/i.test(this.ua);this.iOS=/iphone|ipod|ipad/gi.test(e.navigator.platform);this.iPad=/ipad/gi.test(e.navigator.platform);this.iPhone=/iphone/gi.test(e.navigator.platform);this.iPod=/ipod/gi.test(e.navigator.platform);var a=document.createElement("div");this.is3dSupported=!b.isNothing(a.style.WebkitPerspective);
this.isCSSTransformSupported=!b.isNothing(a.style.WebkitTransform)||!b.isNothing(a.style.MozTransform)||!b.isNothing(a.style.transformProperty);this.isTouchSupported=this.isEventSupported("touchstart");this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(a){var d=document.createElement(this._eventTagNames[a]||"div"),c,a="on"+a;c=b.objectHasProperty(d,a);
c||(d.setAttribute(a,"return;"),c=typeof d[a]==="function");return c}};b.Browser._detect()})(window,window.Code.Util);
(function(e,b,a){a.extend(a,{Events:{add:function(a,c,e){b(a).bind(c,e)},remove:function(a,c,e){b(a).unbind(c,e)},fire:function(a,c){var e,f=Array.prototype.slice.call(arguments).splice(2);e=typeof c==="string"?{type:c}:c;b(a).trigger(b.Event(e.type,e),f)},getMousePosition:function(a){return{x:a.pageX,y:a.pageY}},getTouchEvent:function(a){return a.originalEvent},getWheelDelta:function(d){var b=0;a.isNothing(d.wheelDelta)?a.isNothing(d.detail)||(b=-d.detail/3):b=d.wheelDelta/120;return b},domReady:function(a){b(document).ready(a)}}})})(window,
window.jQuery,window.Code.Util);
(function(e,b,a){a.extend(a,{DOM:{setData:function(d,b,e){a.DOM.setAttribute(d,"data-"+b,e)},getData:function(d,b,e){return a.DOM.getAttribute(d,"data-"+b,e)},removeData:function(d,b){a.DOM.removeAttribute(d,"data-"+b)},isChildOf:function(a,b){if(b===a)return!1;for(;a&&a!==b;)a=a.parentNode;return a===b},find:function(d,c){if(a.isNothing(c))c=e.document;var g=b(d,c),f=[],h,i;h=0;for(i=g.length;h<i;h++)f.push(g[h]);return f},createElement:function(a,c,e){a=b("<"+a+"></"+a+">");a.attr(c);a.append(e);
return a[0]},appendChild:function(a,c){b(c).append(a)},insertBefore:function(a,c){b(a).insertBefore(c)},appendText:function(a,c){b(c).text(a)},appendToBody:function(a){b("body").append(a)},removeChild:function(a){b(a).empty().remove()},removeChildren:function(a){b(a).empty()},hasAttribute:function(d,c){return!a.isNothing(b(d).attr(c))},getAttribute:function(d,c,e){d=b(d).attr(c);a.isNothing(d)&&!a.isNothing(e)&&(d=e);return d},setAttribute:function(a,c,e){b(a).attr(c,e)},removeAttribute:function(a,
c){b(a).removeAttr(c)},addClass:function(a,c){b(a).addClass(c)},removeClass:function(a,c){b(a).removeClass(c)},hasClass:function(a,c){b(a).hasClass(c)},setStyle:function(d,c,e){var f;if(a.isObject(c))for(f in c)a.objectHasProperty(c,f)&&(f==="width"?a.DOM.width(d,c[f]):f==="height"?a.DOM.height(d,c[f]):(b(d).css(f,c[f]),d.style[f]=c[f]));else b(d).css(c,e)},getStyle:function(a,c){return b(a).css(c)},hide:function(a){b(a).hide()},show:function(a){b(a).show()},width:function(d,c){a.isNothing(c)||b(d).width(c);
return b(d).width()},outerWidth:function(a){return b(a).outerWidth()},height:function(d,c){a.isNothing(c)||b(d).height(c);return b(d).height()},outerHeight:function(a){return b(a).outerHeight()},documentWidth:function(){return b(document.documentElement).width()},documentHeight:function(){return b(document.documentElement).height()},documentOuterWidth:function(){return a.DOM.width(document.documentElement)},documentOuterHeight:function(){return a.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return b(document.body).width()},
bodyHeight:function(){return b(document.body).height()},bodyOuterWidth:function(){return a.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return a.DOM.outerHeight(document.body)},windowWidth:function(){if(!e.innerWidth)return b(e).width();return e.innerWidth},windowHeight:function(){if(!e.innerHeight)return b(e).height();return e.innerHeight},windowScrollLeft:function(){if(!e.pageXOffset)return b(e).scrollLeft();return e.pageXOffset},windowScrollTop:function(){if(!e.pageYOffset)return b(e).scrollTop();
return e.pageYOffset}}})})(window,window.jQuery,window.Code.Util);
(function(e,b){b.extend(b,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:e.document.documentElement.style.webkitTransition!==void 0?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:e.document.documentElement.style.webkitTransition!==void 0?"webkitTransition":e.document.documentElement.style.MozTransition!==void 0?"MozTransition":"transition",_transformLabel:e.document.documentElement.style.webkitTransform!==void 0?"webkitTransform":e.document.documentElement.style.MozTransition!==
void 0?"MozTransform":"transform",_getTransitionEndHandler:function(){if(b.isNothing(this._transitionEndHandler))this._transitionEndHandler=this._onTransitionEnd.bind(this);return this._transitionEndHandler},stop:function(a){if(b.Browser.isCSSTransformSupported){var d={};b.Events.remove(a,this._transitionEndLabel,this._getTransitionEndHandler());b.isNothing(a.callbackLabel)&&delete a.callbackLabel;d[this._transitionPrefix+"Property"]="";d[this._transitionPrefix+"Duration"]="";d[this._transitionPrefix+
"TimingFunction"]="";d[this._transitionPrefix+"Delay"]="";d[this._transformLabel]="";b.DOM.setStyle(a,d)}else b.isNothing(e.jQuery)||e.jQuery(a).stop(!0,!0)},fadeIn:function(a,d,c,g,f){f=b.coalesce(f,1);f<=0&&(f=1);if(d<=0&&(b.DOM.setStyle(a,"opacity",f),!b.isNothing(c))){c(a);return}b.DOM.getStyle(a,"opacity")>=1&&b.DOM.setStyle(a,"opacity",0);b.Browser.isCSSTransformSupported?this._applyTransition(a,"opacity",f,d,c,g):b.isNothing(e.jQuery)||e.jQuery(a).fadeTo(d,f,c)},fadeTo:function(a,b,c,e,f){this.fadeIn(a,
c,e,f,b)},fadeOut:function(a,d,c,g){if(d<=0&&(b.DOM.setStyle(a,"opacity",0),!b.isNothing(c))){c(a);return}b.Browser.isCSSTransformSupported?this._applyTransition(a,"opacity",0,d,c,g):e.jQuery(a).fadeTo(d,0,c)},slideBy:function(a,d,c,g,f,h){var i={},d=b.coalesce(d,0),c=b.coalesce(c,0),h=b.coalesce(h,"ease-out");i[this._transitionPrefix+"Property"]="all";i[this._transitionPrefix+"Delay"]="0";g===0?(i[this._transitionPrefix+"Duration"]="",i[this._transitionPrefix+"TimingFunction"]=""):(i[this._transitionPrefix+
"Duration"]=g+"ms",i[this._transitionPrefix+"TimingFunction"]=b.coalesce(h,"ease-out"),b.Events.add(a,this._transitionEndLabel,this._getTransitionEndHandler()));i[this._transformLabel]=b.Browser.is3dSupported?"translate3d("+d+"px, "+c+"px, 0px)":"translate("+d+"px, "+c+"px)";if(!b.isNothing(f))a.cclallcallback=f;b.DOM.setStyle(a,i);g===0&&e.setTimeout(function(){this._leaveTransforms(a)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(a){var d={};d[this._transformLabel]=d[this._transformLabel]=
b.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)";b.DOM.setStyle(a,d)},_applyTransition:function(a,d,c,g,f,h){var i={},h=b.coalesce(h,"ease-in");i[this._transitionPrefix+"Property"]=d;i[this._transitionPrefix+"Duration"]=g+"ms";i[this._transitionPrefix+"TimingFunction"]=h;i[this._transitionPrefix+"Delay"]="0";b.Events.add(a,this._transitionEndLabel,this._getTransitionEndHandler());b.DOM.setStyle(a,i);b.isNothing(f)||(a["ccl"+d+"callback"]=f);e.setTimeout(function(){b.DOM.setStyle(a,
d,c)},this._applyTransitionDelay)},_onTransitionEnd:function(a){b.Events.remove(a.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler());this._leaveTransforms(a.currentTarget)},_leaveTransforms:function(a){var d=a.style[this._transitionPrefix+"Property"],c=d!==""?"ccl"+d+"callback":"cclallcallback",g,d=b.coalesce(a.style.webkitTransform,a.style.MozTransform,a.style.transform),f,h=e.parseInt(b.DOM.getStyle(a,"left"),0),i=e.parseInt(b.DOM.getStyle(a,"top"),0),k,l,j={};d!==""&&(d=b.Browser.is3dSupported?
d.match(/translate3d\((.*?)\)/):d.match(/translate\((.*?)\)/),b.isNothing(d)||(f=d[1].split(", "),k=e.parseInt(f[0],0),l=e.parseInt(f[1],0)));j[this._transitionPrefix+"Property"]="";j[this._transitionPrefix+"Duration"]="";j[this._transitionPrefix+"TimingFunction"]="";j[this._transitionPrefix+"Delay"]="";b.DOM.setStyle(a,j);e.setTimeout(function(){if(!b.isNothing(f))j={},j[this._transformLabel]="",j.left=h+k+"px",j.top=i+l+"px",b.DOM.setStyle(a,j);b.isNothing(a[c])||(g=a[c],delete a[c],g(a))}.bind(this),
this._applyTransitionDelay)}}})})(window,window.Code.Util);
(function(e,b,a){a.registerNamespace("Code.Util.TouchElement");a.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"};a.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}})(window,window.klass,window.Code.Util);
(function(e,b,a){a.registerNamespace("Util.TouchElement");a.TouchElement.TouchElementClass=b({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var b;
this.removeEventHandlers();for(b in this)a.objectHasProperty(this,b)&&(this[b]=null)},initialize:function(b,c){this.el=b;this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0};a.extend(this.captureSettings,c);this.swipeThreshold=50;this.doubleTapSpeed=this.swipeTimeThreshold=250;this.touchStartPoint={x:0,y:0};this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){if(a.isNothing(this.touchStartHandler))this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=
this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this);a.Events.add(this.el,"touchstart",this.touchStartHandler);this.captureSettings.move&&
a.Events.add(this.el,"touchmove",this.touchMoveHandler);a.Events.add(this.el,"touchend",this.touchEndHandler);a.Events.add(this.el,"mousedown",this.mouseDownHandler);a.Browser.isGestureSupported&&this.captureSettings.gesture&&(a.Events.add(this.el,"gesturestart",this.gestureStartHandler),a.Events.add(this.el,"gesturechange",this.gestureChangeHandler),a.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){a.Events.remove(this.el,"touchstart",this.touchStartHandler);
this.captureSettings.move&&a.Events.remove(this.el,"touchmove",this.touchMoveHandler);a.Events.remove(this.el,"touchend",this.touchEndHandler);a.Events.remove(this.el,"mousedown",this.mouseDownHandler);a.Browser.isGestureSupported&&this.captureSettings.gesture&&(a.Events.remove(this.el,"gesturestart",this.gestureStartHandler),a.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),a.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(a){return{x:a[0].pageX,
y:a[0].pageY}},fireTouchEvent:function(){var b=0,c=0,g=0,f,b=this.touchEndPoint.x-this.touchStartPoint.x,c=this.touchEndPoint.y-this.touchStartPoint.y,g=Math.sqrt(b*b+c*c);if(this.captureSettings.swipe&&(f=new Date,f-=this.touchStartTime,f<=this.swipeTimeThreshold)){if(e.Math.abs(b)>=this.swipeThreshold){a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:b<0?a.TouchElement.ActionTypes.swipeLeft:a.TouchElement.ActionTypes.swipeRight});return}if(e.Math.abs(c)>=
this.swipeThreshold){a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c<0?a.TouchElement.ActionTypes.swipeUp:a.TouchElement.ActionTypes.swipeDown});return}}g>1?a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint}):this.captureSettings.doubleTap?a.isNothing(this.doubleTapTimeout)?this.doubleTapTimeout=e.setTimeout(function(){this.doubleTapTimeout=null;a.Events.fire(this,
{type:a.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:a.TouchElement.ActionTypes.tap})}.bind(this),this.doubleTapSpeed):(e.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:a.TouchElement.ActionTypes.doubleTap})):a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:a.TouchElement.ActionTypes.tap})},onTouchStart:function(b){this.captureSettings.preventDefaultTouchEvents&&
b.preventDefault();a.Events.remove(this.el,"mousedown",this.mouseDownHandler);b=a.Events.getTouchEvent(b).touches;b.length>1&&this.captureSettings.gesture?this.isGesture=!0:(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(b),a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint}))},onTouchMove:function(b){this.captureSettings.preventDefaultTouchEvents&&b.preventDefault();
if(!this.isGesture||!this.captureSettings.gesture)b=a.Events.getTouchEvent(b).touches,a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(b)})},onTouchEnd:function(b){if(!this.isGesture||!this.captureSettings.gesture)this.captureSettings.preventDefaultTouchEvents&&b.preventDefault(),b=a.Events.getTouchEvent(b),this.touchEndPoint=this.getTouchPoint(!a.isNothing(b.changedTouches)?b.changedTouches:b.touches),a.Events.fire(this,
{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint}),this.fireTouchEvent()},onMouseDown:function(b){b.preventDefault();a.Events.remove(this.el,"touchstart",this.mouseDownHandler);a.Events.remove(this.el,"touchmove",this.touchMoveHandler);a.Events.remove(this.el,"touchend",this.touchEndHandler);this.captureSettings.move&&a.Events.add(this.el,"mousemove",this.mouseMoveHandler);a.Events.add(this.el,"mouseup",this.mouseUpHandler);a.Events.add(this.el,
"mouseout",this.mouseOutHandler);this.touchStartTime=new Date;this.isGesture=!1;this.touchStartPoint=a.Events.getMousePosition(b);a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint})},onMouseMove:function(b){b.preventDefault();a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchMove,point:a.Events.getMousePosition(b)})},onMouseUp:function(b){b.preventDefault();
this.captureSettings.move&&a.Events.remove(this.el,"mousemove",this.mouseMoveHandler);a.Events.remove(this.el,"mouseup",this.mouseUpHandler);a.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=a.Events.getMousePosition(b);a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint});this.fireTouchEvent()},onMouseOut:function(b){b.preventDefault();this.captureSettings.move&&a.Events.remove(this.el,
"mousemove",this.mouseMoveHandler);a.Events.remove(this.el,"mouseup",this.mouseUpHandler);a.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=a.Events.getMousePosition(b);a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint});this.fireTouchEvent()},onGestureStart:function(b){b.preventDefault();b=a.Events.getTouchEvent(b);a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,
action:a.TouchElement.ActionTypes.gestureStart,scale:b.scale,rotation:b.rotation})},onGestureChange:function(b){b.preventDefault();b=a.Events.getTouchEvent(b);a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.gestureChange,scale:b.scale,rotation:b.rotation})},onGestureEnd:function(b){b.preventDefault();b=a.Events.getTouchEvent(b);a.Events.fire(this,{type:a.TouchElement.EventTypes.onTouch,target:this,action:a.TouchElement.ActionTypes.gestureEnd,
scale:b.scale,rotation:b.rotation})}})})(window,window.klass,window.Code.Util);
